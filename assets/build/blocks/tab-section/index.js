(()=>{"use strict";const t=window.wp.blocks,e=window.wp.element,n=window.wp.i18n,s=window.wp.blockEditor,a=window.wp.data,l=t=>!t||0===Object.keys(t).length&&t.constructor===Object;(0,t.registerBlockType)("decoupled-tabs/tab-section",{edit:function({setAttributes:o,clientId:c}){const r=(0,s.useBlockProps)(),{children:d,...i}=(0,s.useInnerBlocksProps)(r,{allowedBlocks:["decoupled-tabs/tab-content"]}),[b,u]=(0,e.useState)(null),[f,p]=(0,e.useState)(null),[h,k]=(0,e.useState)(!1),{updateBlockAttributes:w,removeBlocks:g,insertBlock:I,replaceInnerBlocks:B}=(0,a.useDispatch)(s.store),m=(0,a.useSelect)((t=>t(s.store).getBlocks(c)),[]),v=(0,a.useSelect)((t=>{const e=t(s.store).getBlocksByName("decoupled-tabs/tabs-selector");return e&&e.length>0?e[0]:null}),[]),C=((t,e)=>(0,a.useSelect)((e=>e(s.store).getBlockAttributes(t)),e))(b,[b]);(0,e.useEffect)((()=>{var t;E(f,C)&&(p(C),o({defaultTabSection:null!==(t=C?.defaultTab)&&void 0!==t?t:""}))}),[C]),(0,e.useEffect)((()=>{v!==b&&(u(v),k(!v))}),[v]),(0,e.useEffect)((()=>{if(T())if(f.tabs.length!==m.length)if(f.tabs.length>m.length)f.tabs.forEach(((e,s)=>{if(!m.find((t=>t.attributes.tabContentId.toLowerCase()===e.id.toLowerCase()))){const a=(0,t.createBlock)("decoupled-tabs/tab-content",{tabContentId:e.id,visible:!1,metadata:{name:`${e.name} - ${(0,n.__)("Content","decoupled-tabs")}`}});I(a,s,c,!1)}}));else{let t=m.filter((t=>!f.tabs.find((e=>e.id===t.attributes.tabContentId))));t?.length||(t=m.filter(((t,e)=>m.findIndex((e=>e.attributes.tabContentId===t.attributes.tabContentId))!==e))),g(t.map((t=>t.clientId)),!1)}else m.forEach((t=>{const e=f.tabs.find((e=>e.oldId===t.attributes.tabContentId)),n={...t.attributes};e&&(n.tabContentId=e.id),n.visible=t.attributes.tabContentId===f.selectedTab,w(t.clientId,n)}))}),[f,m]),(0,e.useEffect)((()=>{h&&B(c,[],!1)}),[h]);const E=(t,e)=>{if(e===t)return!1;if(!e&&t||e&&!t)return!0;if(((t,e)=>t?.selectedTab!==e?.selectedTab)(t,e))return!0;if(((t,e)=>t?.defaultTab!==e?.defaultTab)(t,e))return!0;if(t.tabs.length!==e.tabs.length)return!0;for(let n=0;n<t.tabs.length;n++)if(t.tabs[n].id!==e.tabs[n].id)return!0;return!1},T=()=>!l(f)||!l(C);return(0,e.createElement)("div",i,(b||v)&&T()?T()&&(f?.tabs?.length>0||C?.tabs?.length>0)?null:(0,e.createElement)("p",null,(0,n.__)("No tabs sections available.","decoupled-tabs")):(0,e.createElement)("p",null,(0,n.__)("Please add a tabs selector block to the page.","decoupled-tabs")),d)},save:function(){const t=s.useBlockProps.save(),{children:n,...a}=s.useInnerBlocksProps.save(t);return(0,e.createElement)("div",a,n)}})})();